# è´¢åŠ¡ç¨åŠ¡ä»£ç†å…¬å¸ç½‘ç«™ - æ•°æ®åº“è®¾è®¡æ–‡æ¡?

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†è´¢åŠ¡ç¨åŠ¡ä»£ç†å…¬å¸ç½‘ç«™çš„æ•°æ®åº“è®¾è®¡æ–¹æ¡ˆã€‚è€ƒè™‘åˆ°å®é™…ç”Ÿäº§ç¯å¢ƒçš„éœ€æ±‚ï¼Œæˆ‘ä»¬è®¾è®¡äº†å®Œæ•´çš„æ•°æ®åº“æ¨¡å‹ï¼ŒåŒ…æ‹¬ç”¨æˆ·ç®¡ç†ã€æœåŠ¡ç®¡ç†ã€è®¢å•å¤„ç†ã€å’¨è¯¢ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€?

## æ•°æ®åº“é€‰æ‹©

æ¨èä½¿ç”¨ **MySQL 8.0+** æˆ?**PostgreSQL 13+**ï¼Œä¸¤è€…éƒ½æ”¯æŒï¼?
- äº‹åŠ¡å¤„ç†
- å¤–é”®çº¦æŸ
- JSONæ•°æ®ç±»å‹
- å…¨æ–‡æœç´¢
- è‰¯å¥½çš„æ€§èƒ½ä¼˜åŒ–

## æ•°æ®è¡¨è®¾è®?

### 1. ç”¨æˆ·è¡?(users)
å­˜å‚¨ç½‘ç«™æ³¨å†Œç”¨æˆ·ä¿¡æ¯

```sql
CREATE TABLE users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    phone VARCHAR(20),
    company_name VARCHAR(200),
    is_vip BOOLEAN DEFAULT FALSE,
    vip_expiry_date DATE,
    registration_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP,
    status ENUM('active', 'inactive', 'suspended') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_email (email),
    INDEX idx_phone (phone),
    INDEX idx_company (company_name),
    INDEX idx_vip (is_vip)
);
```

### 2. ç®¡ç†å‘˜è¡¨ (admins)
å­˜å‚¨åå°ç®¡ç†å‘˜ä¿¡æ?

```sql
CREATE TABLE admins (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(100) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    full_name VARCHAR(100) NOT NULL,
    role ENUM('super_admin', 'admin', 'editor') DEFAULT 'editor',
    permissions JSON, -- å­˜å‚¨æƒé™é…ç½®
    last_login TIMESTAMP,
    status ENUM('active', 'inactive') DEFAULT 'active',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_role (role),
    INDEX idx_status (status)
);
```

### 3. æœåŠ¡ç±»åˆ«è¡?(service_categories)
å­˜å‚¨æœåŠ¡åˆ†ç±»ä¿¡æ¯

```sql
CREATE TABLE service_categories (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description TEXT,
    icon VARCHAR(100), -- å›¾æ ‡ç±»åæˆ–å›¾ç‰‡è·¯å¾?
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_active (is_active),
    INDEX idx_sort (sort_order)
);
```

### 4. æœåŠ¡è¡?(services)
å­˜å‚¨å…·ä½“çš„æœåŠ¡é¡¹ç›?

```sql
CREATE TABLE services (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    category_id BIGINT NOT NULL,
    name VARCHAR(200) NOT NULL,
    slug VARCHAR(200) UNIQUE NOT NULL, -- URLå‹å¥½çš„æ ‡è¯?
    description TEXT,
    detailed_description LONGTEXT,
    price_range VARCHAR(100), -- ä»·æ ¼èŒƒå›´ï¼Œå¦‚ "2000-5000å…?
    base_price DECIMAL(10,2), -- åŸºç¡€ä»·æ ¼
    features JSON, -- æœåŠ¡ç‰¹è‰²ï¼Œå­˜å‚¨ä¸ºJSONæ•°ç»„
    required_materials JSON, -- æ‰€éœ€ææ–™æ¸…å•
    processing_time VARCHAR(50), -- å¤„ç†æ—¶é—´
    is_featured BOOLEAN DEFAULT FALSE,
    is_active BOOLEAN DEFAULT TRUE,
    sort_order INT DEFAULT 0,
    meta_title VARCHAR(200),
    meta_description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES service_categories(id) ON DELETE RESTRICT,
    INDEX idx_category (category_id),
    INDEX idx_active (is_active),
    INDEX idx_featured (is_featured),
    INDEX idx_slug (slug)
);
```

### 5. å’¨è¯¢è¡?(consultations)
å­˜å‚¨å®¢æˆ·æäº¤çš„å’¨è¯¢ä¿¡æ?

```sql
CREATE TABLE consultations (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    user_id BIGINT, -- å¯ä¸ºç©ºï¼Œå…è®¸æœªç™»å½•ç”¨æˆ·å’¨è¯?
    name VARCHAR(100) NOT NULL,
    phone VARCHAR(20) NOT NULL,
    email VARCHAR(100),
    company_name VARCHAR(200),
    service_id BIGINT NOT NULL,
    service_name VARCHAR(200), -- å†—ä½™å­˜å‚¨ï¼Œé¿å…æœåŠ¡åˆ é™¤åä¿¡æ¯ä¸¢å¤±
    description TEXT NOT NULL,
    budget_range VARCHAR(100),
    urgency ENUM('low', 'medium', 'high') DEFAULT 'medium',
    status ENUM('pending', 'processing', 'completed', 'cancelled') DEFAULT 'pending',
    assigned_admin_id BIGINT, -- åˆ†é…çš„å¤„ç†ç®¡ç†å‘˜
    admin_notes TEXT, -- ç®¡ç†å‘˜å¤„ç†å¤‡æ³?
    response_time INT, -- å“åº”æ—¶é—´ï¼ˆå°æ—¶ï¼‰
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,
    FOREIGN KEY (service_id) REFERENCES services(id) ON DELETE RESTRICT,
    FOREIGN KEY (assigned_admin_id) REFERENCES admins(id) ON DELETE SET NULL,
    INDEX idx_status (status),
    INDEX idx_urgency (urgency),
    INDEX idx_created (created_at),
    INDEX idx_user (user_id)
);
```

### 6. è®¢å•è¡?(orders)
å­˜å‚¨å®¢æˆ·ä¸‹å•ä¿¡æ¯

```sql
CREATE TABLE orders (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    order_number VARCHAR(50) UNIQUE NOT NULL, -- è®¢å•å·ï¼Œå¦?ORD202401200001
    user_id BIGINT NOT NULL,
    service_id BIGINT NOT NULL,
    service_name VARCHAR(200) NOT NULL,
    service_price DECIMAL(10,2) NOT NULL,
    quantity INT DEFAULT 1,
    total_amount DECIMAL(10,2) NOT NULL,
    customer_notes TEXT,
    status ENUM('pending', 'confirmed', 'processing', 'completed', 'cancelled') DEFAULT 'pending',
    payment_status ENUM('pending', 'paid', 'failed', 'refunded') DEFAULT 'pending',
    payment_method ENUM('alipay', 'wechat', 'bank_transfer', 'cash'),
    payment_date TIMESTAMP,
    assigned_admin_id BIGINT,
    completion_date TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE RESTRICT,
    FOREIGN KEY (service_id) REFERENCES services(id) ON DELETE RESTRICT,
    FOREIGN KEY (assigned_admin_id) REFERENCES admins(id) ON DELETE SET NULL,
    INDEX idx_order_number (order_number),
    INDEX idx_user (user_id),
    INDEX idx_status (status),
    INDEX idx_payment_status (payment_status),
    INDEX idx_created (created_at)
);
```

### 7. æ–‡ç« è¡?(articles)
å­˜å‚¨ç½‘ç«™å‘å¸ƒçš„æ–‡ç« å’Œæ–°é—»

```sql
CREATE TABLE articles (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    slug VARCHAR(200) UNIQUE NOT NULL,
    excerpt TEXT, -- æ‘˜è¦
    content LONGTEXT NOT NULL,
    category ENUM('news', 'knowledge', 'policy', 'tips') DEFAULT 'news',
    author_id BIGINT NOT NULL,
    featured_image VARCHAR(500), -- ç‰¹è‰²å›¾ç‰‡è·¯å¾„
    status ENUM('draft', 'published', 'archived') DEFAULT 'draft',
    published_at TIMESTAMP,
    view_count INT DEFAULT 0,
    meta_title VARCHAR(200),
    meta_description TEXT,
    tags JSON, -- æ ‡ç­¾æ•°ç»„
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (author_id) REFERENCES admins(id) ON DELETE RESTRICT,
    INDEX idx_category (category),
    INDEX idx_status (status),
    INDEX idx_published (published_at),
    INDEX idx_slug (slug)
);
```

### 8. å¸¸è§é—®é¢˜è¡?(faqs)
å­˜å‚¨å¸¸è§é—®é¢˜åŠè§£ç­?

```sql
CREATE TABLE faqs (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    question VARCHAR(500) NOT NULL,
    answer TEXT NOT NULL,
    category VARCHAR(100), -- é—®é¢˜åˆ†ç±»
    sort_order INT DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    view_count INT DEFAULT 0,
    helpful_count INT DEFAULT 0, -- æœ‰å¸®åŠ©è®¡æ•?
    not_helpful_count INT DEFAULT 0, -- æ— å¸®åŠ©è®¡æ•?
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_category (category),
    INDEX idx_active (is_active),
    INDEX idx_sort (sort_order)
);
```

### 9. ç³»ç»Ÿè®¾ç½®è¡?(system_settings)
å­˜å‚¨ç½‘ç«™é…ç½®ä¿¡æ¯

```sql
CREATE TABLE system_settings (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    setting_key VARCHAR(100) UNIQUE NOT NULL,
    setting_value TEXT,
    setting_type ENUM('string', 'number', 'boolean', 'json') DEFAULT 'string',
    description TEXT,
    is_public BOOLEAN DEFAULT FALSE, -- æ˜¯å¦å…¬å¼€ç»™å‰ç«?
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_key (setting_key),
    INDEX idx_public (is_public)
);
```

### 10. æ–‡ä»¶è¡?(files)
å­˜å‚¨ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ?

```sql
CREATE TABLE files (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    filename VARCHAR(255) NOT NULL,
    original_name VARCHAR(255),
    file_path VARCHAR(500) NOT NULL,
    file_size BIGINT,
    mime_type VARCHAR(100),
    uploader_id BIGINT, -- ä¸Šä¼ è€…ID
    uploader_type ENUM('user', 'admin') DEFAULT 'admin',
    is_public BOOLEAN DEFAULT TRUE,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_uploader (uploader_id, uploader_type),
    INDEX idx_public (is_public),
    INDEX idx_created (created_at)
);
```

## åˆå§‹æ•°æ®

### æœåŠ¡ç±»åˆ«åˆå§‹æ•°æ®
```sql
INSERT INTO service_categories (name, description, icon, sort_order) VALUES
('å·¥å•†ä»£ç†', 'ä¼ä¸šæ³¨å†Œã€å˜æ›´ã€æ³¨é”€ç­‰å·¥å•†äº‹åŠ?, 'fa-building', 1),
('çŸ¥è¯†äº§æƒ', 'å•†æ ‡æ³¨å†Œã€ç‰ˆæƒç™»è®°ã€ä¸“åˆ©ç”³è¯?, 'fa-copyright', 2),
('ä¼šè®¡æœåŠ¡', 'ç¨åŠ¡ç”³æŠ¥ã€è´¢åŠ¡ä»£ç†ã€å®¡è®¡æœåŠ?, 'fa-calculator', 3),
('é“¶è¡Œå¼€æˆ?, 'å¯¹å…¬è´¦æˆ·è®¾ç«‹ã€é‡‘èæœåŠ?, 'fa-university', 4);
```

### æœåŠ¡é¡¹ç›®åˆå§‹æ•°æ®
```sql
INSERT INTO services (category_id, name, slug, description, price_range, base_price) VALUES
(1, 'å…¬å¸æ³¨å†Œ', 'company-registration', 'ä¸“ä¸šçš„ä¼ä¸šå·¥å•†ä»£ç†æœåŠ?, '2000-5000å…?, 3000.00),
(1, 'å…¬å¸å˜æ›´', 'company-change', 'å…¬å¸ä¿¡æ¯å˜æ›´æœåŠ¡', '1000-3000å…?, 1500.00),
(2, 'å•†æ ‡æ³¨å†Œ', 'trademark-registration', 'å…¨é¢çš„çŸ¥è¯†äº§æƒæœåŠ?, '1500-3000å…?, 2000.00),
(3, 'ä¼šè®¡ä»£ç†', 'accounting-service', 'ä¸“ä¸šçš„ä¼šè®¡æœåŠ?, '500-2000å…?æœ?, 800.00),
(4, 'é“¶è¡Œå¼€æˆ?, 'bank-account-opening', 'é“¶è¡Œå¼€æˆ·åŠé‡‘èæœåŠ¡', '1000-3000å…?, 1500.00);
```

### ç³»ç»Ÿè®¾ç½®åˆå§‹æ•°æ®
```sql
INSERT INTO system_settings (setting_key, setting_value, setting_type, description, is_public) VALUES
('site_name', 'é‘«åšè´¢ç¨ä»£ç†', 'string', 'ç½‘ç«™åç§°', TRUE),
('site_description', 'ä¸“ä¸šè´¢åŠ¡ç¨åŠ¡ä»£ç†æœåŠ¡ï¼Œä¸€ç«™å¼ä¼ä¸šæœåŠ¡è§£å†³æ–¹æ¡ˆ', 'string', 'ç½‘ç«™æè¿°', TRUE),
('contact_phone', '+86-0755-85216839', 'string', 'è”ç³»ç”µè¯', TRUE),
('contact_email', '1006993710@qq.com', 'string', 'è”ç³»é‚®ç®±', TRUE),
('business_hours', 'å‘¨ä¸€è‡³å‘¨äº?9:00-18:00', 'string', 'è¥ä¸šæ—¶é—´', TRUE),
('maintenance_mode', 'false', 'boolean', 'ç»´æŠ¤æ¨¡å¼', FALSE);
```

## ç´¢å¼•ä¼˜åŒ–å»ºè®®

### å¸¸ç”¨æŸ¥è¯¢ç´¢å¼•
```sql
-- ç”¨æˆ·ç›¸å…³æŸ¥è¯¢
CREATE INDEX idx_users_composite ON users(email, status);
CREATE INDEX idx_users_vip_date ON users(is_vip, registration_date);

-- è®¢å•ç›¸å…³æŸ¥è¯¢
CREATE INDEX idx_orders_composite ON orders(user_id, status, created_at);
CREATE INDEX idx_orders_date_range ON orders(created_at, payment_status);

-- å’¨è¯¢ç›¸å…³æŸ¥è¯¢
CREATE INDEX idx_consultations_composite ON consultations(status, urgency, created_at);
CREATE INDEX idx_consultations_admin ON consultations(assigned_admin_id, status);

-- æ–‡ç« ç›¸å…³æŸ¥è¯¢
CREATE INDEX idx_articles_composite ON articles(status, category, published_at);
CREATE INDEX idx_articles_search ON articles(title, excerpt);
```

### å…¨æ–‡æœç´¢ç´¢å¼•ï¼ˆMySQLï¼?
```sql
-- ä¸ºæ–‡ç« æ ‡é¢˜å’Œå†…å®¹åˆ›å»ºå…¨æ–‡ç´¢å¼•
ALTER TABLE articles ADD FULLTEXT(title, excerpt, content);

-- ä¸ºæœåŠ¡æè¿°åˆ›å»ºå…¨æ–‡ç´¢å¼?
ALTER TABLE services ADD FULLTEXT(name, description);

-- ä¸ºå¸¸è§é—®é¢˜åˆ›å»ºå…¨æ–‡ç´¢å¼?
ALTER TABLE faqs ADD FULLTEXT(question, answer);
```

## å®‰å…¨è€ƒè™‘

### æ•°æ®åŠ å¯†
- ç”¨æˆ·å¯†ç ä½¿ç”¨ bcrypt æˆ?Argon2 åŠ å¯†
- æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚æ‰‹æœºå·ï¼‰å¯è€ƒè™‘åŠ å¯†å­˜å‚¨
- APIå¯†é’¥å’Œä»¤ç‰Œä½¿ç”¨å®‰å…¨å“ˆå¸?

### æ•°æ®å¤‡ä»½
- å®šæœŸè‡ªåŠ¨å¤‡ä»½æ•°æ®åº?
- å¤‡ä»½æ–‡ä»¶åŠ å¯†å­˜å‚¨
- å¼‚åœ°å¤‡ä»½ç­–ç•¥

### è®¿é—®æ§åˆ¶
- ä¸¥æ ¼çš„æ•°æ®åº“ç”¨æˆ·æƒé™ç®¡ç†
- ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥é˜²æ­¢SQLæ³¨å…¥
- è¾“å…¥æ•°æ®éªŒè¯å’Œæ¸…ç?

## æ€§èƒ½ä¼˜åŒ–

### æŸ¥è¯¢ä¼˜åŒ–
- é¿å… SELECT *ï¼Œåªé€‰æ‹©éœ€è¦çš„å­—æ®µ
- åˆç†ä½¿ç”¨ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æ?
- ä½¿ç”¨åˆ†é¡µæŸ¥è¯¢å¤§æ•°æ®é›†

### ç¼“å­˜ç­–ç•¥
- ä½¿ç”¨Redisç¼“å­˜çƒ­ç‚¹æ•°æ®
- æŸ¥è¯¢ç»“æœç¼“å­˜
- é¡µé¢é™æ€åŒ–

### æ•°æ®åº“é…ç½?
- åˆç†çš„è¿æ¥æ± é…ç½®
- å®šæœŸä¼˜åŒ–è¡¨ç»“æ?
- ç›‘æ§æ…¢æŸ¥è¯¢æ—¥å¿?

## æ‰©å±•æ€§è€ƒè™‘

### åˆ†åº“åˆ†è¡¨
å½“æ•°æ®é‡å¢é•¿æ—¶ï¼Œå¯ä»¥è€ƒè™‘ï¼?
- æŒ‰ä¸šåŠ¡æ¨¡å—åˆ†åº?
- æŒ‰æ—¶é—´èŒƒå›´åˆ†è¡¨ï¼ˆå¦‚æŒ‰å¹´åˆ†è¡¨ï¼‰
- ç”¨æˆ·æ•°æ®åˆ†ç‰‡

### è¯»å†™åˆ†ç¦»
- ä¸»æ•°æ®åº“å¤„ç†å†™æ“ä½?
- ä»æ•°æ®åº“å¤„ç†è¯»æ“ä½?
- ä½¿ç”¨æ•°æ®åº“ä¸­é—´ä»¶

è¿™ä¸ªæ•°æ®åº“è®¾è®¡ä¸ºè´¢åŠ¡ç¨åŠ¡ä»£ç†å…¬å¸ç½‘ç«™æä¾›äº†å®Œæ•´çš„æ•°æ®å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒç°æœ‰çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶è€ƒè™‘äº†æœªæ¥çš„æ‰©å±•éœ€æ±‚ã€
